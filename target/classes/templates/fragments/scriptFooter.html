<!-- scriptFooter.html -->
<div th:fragment="scriptFooter">
  <!-- Bootstrap Bundle JS (safe version) -->
  <!-- Bootstrap Bundle (JS) - No integrity to avoid mismatch -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"
    defer
  ></script>

  <!-- Material Design Lite JavaScript -->
  <script src="https://code.getmdl.io/1.3.0/material.min.js" defer></script>

  <!-- Enable keyboard skip link & dark mode toggle -->
  <script>
        document.addEventListener("DOMContentLoaded", function () {
          // WCAG skip link support
          const skipLink = document.querySelector(".skip-link");
          if (skipLink) {
            skipLink.addEventListener("focus", () => {
              skipLink.style.position = "static";
            });
            skipLink.addEventListener("blur", () => {
              skipLink.style.position = "absolute";
            });
          }

          // Dark mode toggle support
          function setupDarkModeToggle() {
      const toggleButton = document.querySelector(".toggle-dark-mode");
      if (!toggleButton) return;

      // Load saved mode
      if (localStorage.getItem("dark-mode") === "true") {
        document.body.classList.add("dark-mode");
      }

      // Listen for toggle
      toggleButton.addEventListener("click", () => {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem("dark-mode", document.body.classList.contains("dark-mode"));
      });
    }

    document.addEventListener("DOMContentLoaded", function () {
      // Setup skip link
      const skipLink = document.querySelector(".skip-link");
      if (skipLink) {
        skipLink.addEventListener("focus", () => skipLink.style.position = "static");
        skipLink.addEventListener("blur", () => skipLink.style.position = "absolute");
      }

      // Delay setup of dark mode to ensure fragments are rendered
      setTimeout(setupDarkModeToggle, 0);
    });
  </script>
</div>
